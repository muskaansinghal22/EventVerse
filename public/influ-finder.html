<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Find Influencer</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.8.3/angular.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
        integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"
        integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy"
        crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <script>
        var module = angular.module("mymodule", []);
        var controller = module.controller("mycontroller", function ($scope, $http) {

            $scope.fillcities = function () {
                if ($scope.selectedField) {
                    let url = "/fetch-cities?fields=" + $scope.selectedField;
                    $http.get(url).then(function (response) {
                        $scope.jsonarray = response.data;
                    }, function (err) {
                        alert(err.statusText);
                    });
                }
            };

            $scope.findnow = function () {
                if ($scope.selectedField && $scope.selectedcity) {
                    let url = "/search-influ?fields=" + $scope.selectedField + "&city=" + $scope.selectedcity;
                    $http.get(url).then(function (response) {
                        $scope.jsonarray = response.data;
                    }, function (err) {
                        alert(err.statusText);
                    });
                }
            };

            $scope.searchByName = function () {
                if ($scope.searchName) {
                    let url = "/search-influencer?iname=" + $scope.searchName;
                    $http.get(url).then(function (response) {
                        $scope.jsonarray = response.data;
                    }, function (err) {
                        alert(err.statusText);
                    });
                }
            };

            $scope.showinfo = function (index) {
                $scope.fulldetailobj = $scope.jsonarray[index];
            }
        });
    </script>
    <script>
        $(document).ready(function () {
            if (active == null) {
                location.href = "index.html";
                return;
            }

        })

        function doLogout() {
            localStorage.removeItem("activeuser");
            location.href = "index.html";
        }  
    </script>
    <style>
        .modal-body img {
            border-radius: 50%;
            display: block;
            margin-left: auto;
            margin-right: auto;
            box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);
            object-fit: contain;
            max-width: 200px;
            max-height: 200px;
        }

        .modal-header,
        .modal-footer {
            border: none;
            background: linear-gradient(135deg, #e0e0e0, #f5f5f5);
            color: #333;
        }

        .modal-title {
            text-align: center;
            width: 100%;
            font-size: 1.5rem;
        }

        .info-label {
            font-weight: bold;
            color: #6c757d;
        }

        .social-links p {
            margin: 20px 0px;
            margin-top: 23px;
        }

        .social-links p span {
            color: #007bff;
            font-weight: bold;
        }

        .personal-info {
            text-align: left;
        }

        .social-links {
            text-align: left;
            margin-top: 20px;
            margin-left: 100px;
        }

        .social-links p span {
            color: #ff4081;
        }
    </style>
</head>

<body ng-app="mymodule" ng-controller="mycontroller" style="padding-top: 70px;">
    <nav class="navbar navbar-expand-lg bg-body-tertiary fixed-top">
        <div class="container-fluid">
            <p>LOGO</p>
            <a class="navbar-brand" href="index.html">EventVerse</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <form class="d-flex">
                <button class="btn btn-outline-danger" type="button" data-bs-toggle="modal"
                    data-bs-target="#exampleModallog" onclick="doLogout()">Logout</button>
            </form>
        </div>
    </nav>
    <div class="container">
        <center>
            <h2>Find Influencer</h2>
        </center>
        <h4>Select Field</h4>

        <input type="text" list="value" ng-model="selectedField" ng-change="fillcities();" class="form-control">
        <datalist id="value">
            <option value="" disabled selected>Select Field</option>
                        <option value="Skincare">Skincare</option>
                        <option value="Singing">Singing</option>
                        <option value="Dancing">Dancing</option>
                        <option value="Beauty">Beauty</option>
                        <option value="Finance">Finance</option>
                        <option value="Fashion">Fashion</option>
                        <option value="Health and Wellness">Health and Wellness</option>
                        <option value="Business">Business</option>
                        <option value="Fitness">Fitness</option>
                        <option value="Food">Food</option>
                        <option value="Travel">Travel</option>
                        <option value="Video Game">Video Game</option>
                        <option value="Vlogger">Vlogger</option>
                        <option value="Photographer">Photographer</option>
        </datalist>
        <br />
        <h4>Select City</h4>
        <input type="text" list="city" class="form-control" ng-change="fillcities()" ng-model="selectedcity">
        <datalist id="city">
            <option value="">Select a city</option>
            <option ng-repeat="obj in jsonarray" value="{{obj.city}}">{{obj.city}}</option>
        </datalist>

        <br>
        <input type="submit" value="Find Now" ng-click="findnow();" class="btn btn-primary">
        <br>
        <h4>Enter Name</h4>
        <input type="text" ng-model="searchName" class="form-control" id="findbyname" name="findbyname">
        <br>
        <input type="submit" value="Find By Name" ng-click="searchByName();" class="btn btn-primary">
    </div>
    <br>
    <div class="container">
        <div class="row">
            <div class="col-md-4 mb-3" ng-repeat="obj in jsonarray">
                <div class="card" style="width: 18rem; margin: 0 auto;">
                    <img src="/uploads/{{obj.picpath}}" class="card-img-top" alt="..." height="300px" width="100px">
                    <div class="card-body">
                        <h5 class="card-title text-center">Name: {{obj.iname}}</h5>
                        <p class="card-text">Gender: {{obj.gender}}</p>
                        <p class="card-text">DOB: {{obj.dob}}</p>
                        <p class="card-text">City: {{obj.city}}</p>
                        <a href="#" class="btn btn-primary" data-bs-toggle="modal"
                            data-bs-target="#details{{$index}}">Read More</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal -->
    <div ng-repeat="obj in jsonarray" class="modal fade" id="details{{$index}}" tabindex="-1"
        aria-labelledby="detailsLabel{{$index}}" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="detailsLabel{{$index}}">Profile Details</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-4 text-center">
                            <img src="/uploads/{{obj.picpath}}" alt="Profile Picture" height="200" width="200">
                        </div>
                        <div class="col-md-8">
                            <div class="social-links">
                                <a href="{{obj.insta}}"><p><span>Instagram:</span></p></a>
                                <a href="{{obj.fb}}"><p><span>Facebook:</span> </p></a>
                                <a href="{{obj.youtube}}"><p><span>YouTube:</span> </p></a>
                                <a href="{{obj.others}}"><p><span>Other:</span> </p></a>
                            </div>
                        </div>
                    </div>
                    <div class="mt-3 personal-info">
                        <p><span class="info-label">Email:</span> {{obj.emailid}}</p>
                        <p><span class="info-label">Name:</span> {{obj.iname}}</p>
                        <p><span class="info-label">Gender:</span> {{obj.gender}}</p>
                        <p><span class="info-label">DOB:</span> {{obj.dob}}</p>
                        <p><span class="info-label">Address:</span> {{obj.address}}</p>
                        <p><span class="info-label">City:</span> {{obj.city}}</p>
                        <p><span class="info-label">Contact:</span> {{obj.contact}}</p>
                        <p><span class="info-label">Field:</span> {{obj.fields}}</p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

</body>

</html>